#! /usr/bin/env node

const request = require('request')
const parser = require('../lib/parser')
const formatter = require('../lib/formatter')

let [, , username, dest] = process.argv

if (!username) {
  throw new Error('Missing username argument')
}
if (!dest) {
  dest = '.'
}

const url = `http://www.last.fm/user/${username}/journal`

request(url, function (error, response, body) {
  if (!error && response.statusCode === 200) {
    parser(body).map(journal => {
      console.log(formatter(journal))
    })
  }
})
